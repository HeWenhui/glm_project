<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éš”ç¦»æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            color: #fff;
        }
        #test-container {
            text-align: center;
        }
        h1 { color: #4CAF50; margin-bottom: 30px; }
        #status { color: #fff; margin: 20px 0; }
        button {
            padding: 20px 40px;
            font-size: 24px;
            background: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
        }
        button:hover { background: #45a049; }
        #console-log {
            margin-top: 30px;
            background: #111;
            padding: 20px;
            border-radius: 8px;
            text-align: left;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 5px;
        }
        .log-error { color: #f44336; }
        .log-warn { color: #ff9800; }
        .log-info { color: #2196f3; }
        .log-success { color: #4CAF50; }
    </style>
</head>
<body>
    <div id="test-container">
        <h1>ğŸ§ª éš”ç¦»æ¸¸æˆæµ‹è¯•</h1>

        <div id="status">ç­‰å¾…æ“ä½œ...</div>

        <button id="btn1" onclick="test1()">æµ‹è¯•1: ç®€å•æŒ‰é’®</button>
        <button id="btn2" onclick="test2()">æµ‹è¯•2: åœºæ™¯åˆ‡æ¢</button>
        <button id="btn3" onclick="test3()">æµ‹è¯•3: åŠ è½½å®é™…æ¸¸æˆ</button>
        <button id="btn4" onclick="test4()">æµ‹è¯•4: æ¸…é™¤æ§åˆ¶å°</button>

        <div id="console-log">
            <div class="log-entry log-info">æ§åˆ¶å°æ—¥å¿—å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
        </div>
    </div>

    <script>
        // é‡å†™consoleæ–¹æ³•æ•è·æ‰€æœ‰è¾“å‡º
        const originalConsole = {
            log: console.log,
            warn: console.warn,
            error: console.error,
            info: console.info
        };

        const logDiv = document.getElementById('console-log');

        function addLog(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;

            // åŒæ—¶è¾“å‡ºåˆ°åŸå§‹console
            originalConsole.log(message);
        }

        // æ•è·æ‰€æœ‰consoleè¾“å‡º
        console.log = function(msg) { addLog(msg, 'info'); };
        console.warn = function(msg) { addLog(msg, 'warn'); };
        console.error = function(msg) { addLog(msg, 'error'); };
        console.info = function(msg) { addLog(msg, 'info'); };

        // æ•è·å…¨å±€é”™è¯¯
        window.onerror = function(msg, source, lineno, colno, error) {
            addLog(`é”™è¯¯: ${msg} åœ¨ ${source}:${lineno}`, 'error');
            addLog(`è¯¦æƒ…: ${error}`, 'error');
            alert(`JavaScripté”™è¯¯: ${msg}\nä½ç½®: ${source}:${lineno}`);
        };

        window.addEventListener('unhandledrejection', function(event) {
            addLog(`æœªå¤„ç†çš„Promise: ${event.reason}`, 'error');
        });

        addLog('éš”ç¦»æµ‹è¯•é¡µé¢å·²åŠ è½½', 'success');
        document.getElementById('status').textContent = 'å‡†å¤‡å°±ç»ª';

        function test1() {
            addLog('--- æµ‹è¯•1å¼€å§‹ ---', 'info');
            const btn = document.getElementById('btn1');
            btn.textContent = 'ç‚¹å‡»ä¸­...';
            btn.disabled = true;

            setTimeout(() => {
                addLog('æµ‹è¯•1å®Œæˆï¼', 'success');
                btn.textContent = 'æµ‹è¯•1: ç®€å•æŒ‰é’® âœ“';
                btn.disabled = false;
            }, 500);
        }

        function test2() {
            addLog('--- æµ‹è¯•2å¼€å§‹ ---', 'info');
            const btn = document.getElementById('btn2');
            btn.textContent = 'ç‚¹å‡»ä¸­...';
            btn.disabled = true;

            // æµ‹è¯•åŠ è½½ä¸€ä¸ªæ¨¡å—
            import('./js/scenes/MenuScene.js')
                .then(module => {
                    addLog('MenuScene.js æ¨¡å—åŠ è½½æˆåŠŸ', 'success');
                    btn.textContent = 'æµ‹è¯•2: åœºæ™¯åˆ‡æ¢ âœ“';
                    btn.disabled = false;
                })
                .catch(error => {
                    addLog(`æ¨¡å—åŠ è½½å¤±è´¥: ${error.message}`, 'error');
                    btn.textContent = 'æµ‹è¯•2: åœºæ™¯åˆ‡æ¢ âœ—';
                    btn.disabled = false;
                });
        }

        function test3() {
            addLog('--- æµ‹è¯•3å¼€å§‹ ---', 'info');
            const btn = document.getElementById('btn3');
            btn.textContent = 'åŠ è½½ä¸­...';
            btn.disabled = true;

            window.location.href = 'index.html';
        }

        function test4() {
            addLog('--- æµ‹è¯•4å¼€å§‹ ---', 'info');
            const btn = document.getElementById('btn4');
            btn.textContent = 'æ¸…é™¤ä¸­...';
            btn.disabled = true;

            setTimeout(() => {
                logDiv.innerHTML = '<div class="log-entry log-info">æ§åˆ¶å°å·²æ¸…é™¤</div>';
                btn.textContent = 'æµ‹è¯•4: æ¸…é™¤æ§åˆ¶å° âœ“';
                btn.disabled = false;
            }, 300);
        }

        // é¡µé¢åŠ è½½å®Œæˆ
        addLog('éš”ç¦»æµ‹è¯•å°±ç»ªï¼Œå¯ä»¥è¿›è¡Œæµ‹è¯•', 'success');
    </script>
</body>
</html>
